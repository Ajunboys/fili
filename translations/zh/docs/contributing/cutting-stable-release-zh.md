如何发布稳定版本
================

Fili 的开发是循序渐进的，在某一时机所有的修改被打包后会出现一个"发布版本"，用来长期支持。理想情况下，发布的时机应该是
在马上进行大的代码重构或者大的修改之前。发布得越频繁，用户需要做的修改就越可能小。本文介绍如何发布一个新版本。

处理当前稳定版本的 Changelog
----------------------------

Fili 开发过程中，修改日志被写入开发记录，这些记录概括了所做的修改，放进了 [CHANGELOG](/CHANGELOG.md) 的 "current" 单元。
发布新版本的时候，需要回顾这些修改，确保无误，附上发布版本编号，最后将其移至一个不可修改的单元，防止新内容进入其中。具体
步骤是：

1. 把 [README.md](/README.md) 里 Bintray 稳定版号改成新版本号。文字和链接都要修改。
2. 把 CHANGELOG "current" 单元的标题改成新版本号加上发布日期。
3. 回顾检查这个 "current" 单元里所有的修改。
4. changelog 里添加一个新的 "current" 单元，里面添加空的 `Changed`，`Deprecated`，`Fixed`，`Known Issues`，`Removed` 
   子单元。
5. 把以上的改动变成一个 PR ，合并，完成发布。

开始下一阶段的开发
------------------

新的稳定版发布之后，我们需要划定下一阶段的开发基础，所有新的开发和修改都要在此基础上，一定不能在稳定版本上开发，具体操作
步骤如下：

1. 更新 [`pom.xml`](/pom.xml) 文件里的 `version.fili` 和 `version` 参数，改成下一个新的开发版本
   （development version snapshot）
2. 把所有模块里 `pom.xml` 文件的 `parent`->`version` 参数改成一个新的开发版本

   <sub>备注：maven 可能有相关的功能支持全局修改，不过用搜索+修改（search-replace）其实也可以完成。</sub>

### 后期编译

我们的 CI/CD 自动发布脚本会在老版本号上加入 "start next development line"。我们不想这样，我们想让
"start next development line" 变成诸如 "vX.Y.0" 这样的文字。操作方法是：

1. 在 commit 里加入正确的下一版本标签。举个例子，如果新版本是 `v0.7.x`，那么就用 `v0.8.0` ，这样的话就能重新编译并生成
   正确的版本号，
2. 在 Bintray 里删除过高版本，
3. 在 repo 里删除过高版本。
